(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{2821:function(e,r,a){Promise.resolve().then(a.bind(a,5442))},5442:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return n}});var s=a(7437),l=a(9755),t=a(8563),d=a(2265),i=a(6312);function n(){let[e,r]=(0,d.useState)([]),[a,n]=(0,d.useState)(!0),[c,o]=(0,d.useState)(null),[m,x]=(0,d.useState)(""),[u,h]=(0,d.useState)(1),[b,p]=(0,d.useState)(20),[g,j]=(0,d.useState)(0),[v,y]=(0,d.useState)(!1),[N,f]=(0,d.useState)({email:"",full_name:"",role:"member",password:""}),[w,k]=(0,d.useState)(!1);(0,d.useEffect)(()=>{C()},[u,b]);let C=async()=>{n(!0);let e=new URLSearchParams({page:String(u),page_size:String(b)});m.trim()&&e.set("q",m.trim());let a=await i.x.get("/api/v1/users?".concat(e.toString()));n(!1),a.data?(r(a.data.users||[]),j(a.data.total||0)):a.error&&o(a.error)},S=async()=>{k(!0);let e=await i.x.post("/api/v1/users",N);k(!1),e.data?(y(!1),f({email:"",full_name:"",role:"member",password:""}),await C()):e.error&&alert(e.error)},[_,E]=(0,d.useState)(!1),[R,U]=(0,d.useState)(!1),[I,P]=(0,d.useState)({email:"",full_name:"",role:"member"}),[A,D]=(0,d.useState)(null),O=async()=>{U(!0);let e=await i.x.post("/api/v1/users/invite",I);if(U(!1),e.data){let r=e.data.invite_token;D("".concat(window.location.origin,"/accept-invite?token=").concat(encodeURIComponent(r)))}else e.error&&alert(e.error)},q=async(e,r)=>{let a=await i.x.put("/api/v1/users/".concat(e),r);a.error?alert(a.error):await C()},z=async e=>{if(!confirm("Delete this user?"))return;let r=await i.x.delete("/api/v1/users/".concat(e));r.error?alert(r.error):await C()};return(0,s.jsx)(l.Z,{requiredRole:"admin",children:(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,s.jsx)(t.Z,{}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Users"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Manage members of your organization"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Invite User"}),(0,s.jsx)("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"+ Add User"})]})]}),(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{placeholder:"Search name or email...",value:m,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(h(1),C())},className:"w-64 px-3 py-2 border border-gray-300 rounded-md"}),(0,s.jsx)("button",{onClick:()=>{h(1),C()},className:"px-3 py-2 border rounded-md",children:"Search"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("span",{children:"Rows:"}),(0,s.jsx)("select",{value:b,onChange:e=>{p(Number(e.target.value)),h(1)},className:"border-gray-300 rounded-md",children:[10,20,50,100].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]}),a?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):c?(0,s.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded text-red-700",children:c}):(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow overflow-hidden",children:[(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active"}),(0,s.jsx)("th",{className:"px-4 py-3"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.full_name}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.email}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsxs)("select",{value:e.role,onChange:r=>q(e.id,{role:r.target.value}),className:"text-sm border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"admin",children:"admin"}),(0,s.jsx)("option",{value:"member",children:"member"}),(0,s.jsx)("option",{value:"viewer",children:"viewer"})]})}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("input",{type:"checkbox",checked:e.is_active,onChange:r=>q(e.id,{is_active:r.target.checked})})}),(0,s.jsx)("td",{className:"px-4 py-3 text-right",children:(0,s.jsx)("button",{onClick:()=>z(e.id),className:"px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Delete"})})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border-t border-gray-200 text-sm",children:[(0,s.jsxs)("div",{children:["Showing ",e.length?(u-1)*b+1:0,"â€“",(u-1)*b+e.length," of ",g]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{disabled:u<=1,onClick:()=>h(e=>Math.max(1,e-1)),className:"px-3 py-1.5 border rounded disabled:opacity-50",children:"Prev"}),(0,s.jsxs)("div",{children:["Page ",u]}),(0,s.jsx)("button",{disabled:u*b>=g,onClick:()=>h(e=>e+1),className:"px-3 py-1.5 border rounded disabled:opacity-50",children:"Next"})]})]})]}),v&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 w-full max-w-md",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 font-medium",children:"Add User"}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Full Name"}),(0,s.jsx)("input",{value:N.full_name,onChange:e=>f({...N,full_name:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Email"}),(0,s.jsx)("input",{type:"email",value:N.email,onChange:e=>f({...N,email:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Role"}),(0,s.jsxs)("select",{value:N.role,onChange:e=>f({...N,role:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"admin",children:"admin"}),(0,s.jsx)("option",{value:"member",children:"member"}),(0,s.jsx)("option",{value:"viewer",children:"viewer"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Temporary Password"}),(0,s.jsx)("input",{type:"password",value:N.password,onChange:e=>f({...N,password:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 rounded-md border border-gray-300",children:"Cancel"}),(0,s.jsx)("button",{onClick:S,disabled:w||!N.email||!N.full_name||!N.password,className:"px-4 py-2 rounded-md text-white ".concat(w?"bg-blue-300":"bg-blue-600 hover:bg-blue-700"),children:w?"Creating...":"Create"})]})]})}),_&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 w-full max-w-md",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 font-medium",children:"Invite User"}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Full Name"}),(0,s.jsx)("input",{value:I.full_name,onChange:e=>P({...I,full_name:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Email"}),(0,s.jsx)("input",{type:"email",value:I.email,onChange:e=>P({...I,email:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-700",children:"Role"}),(0,s.jsxs)("select",{value:I.role,onChange:e=>P({...I,role:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"admin",children:"admin"}),(0,s.jsx)("option",{value:"member",children:"member"}),(0,s.jsx)("option",{value:"viewer",children:"viewer"})]})]}),A?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-700 mb-1",children:"Invitation Link"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{readOnly:!0,value:A,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-xs"}),(0,s.jsx)("button",{onClick:()=>navigator.clipboard.writeText(A),className:"px-3 py-2 border rounded",children:"Copy"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Share this link with the user to set their password."})]}):null]}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>{E(!1),D(null),P({email:"",full_name:"",role:"member"})},className:"px-4 py-2 rounded-md border border-gray-300",children:"Close"}),!A&&(0,s.jsx)("button",{onClick:O,disabled:R||!I.email||!I.full_name,className:"px-4 py-2 rounded-md text-white ".concat(R?"bg-indigo-300":"bg-indigo-600 hover:bg-indigo-700"),children:R?"Sending...":"Send Invite"})]})]})})]})})]})})}},4033:function(e,r,a){e.exports=a(5313)}},function(e){e.O(0,[311,67,971,458,744],function(){return e(e.s=2821)}),_N_E=e.O()}]);