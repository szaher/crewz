(()=>{var e={};e.id=266,e.ids=[266],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5625:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>c.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>l});var s=r(482),a=r(9108),n=r(2563),c=r.n(n),o=r(8300),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let l=["",{children:["executions",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8460)),"/Users/blackghost/go/src/github.com/szaher/crewzx/crewz/frontend/src/app/executions/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8853)),"/Users/blackghost/go/src/github.com/szaher/crewzx/crewz/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/blackghost/go/src/github.com/szaher/crewzx/crewz/frontend/src/app/executions/[id]/page.tsx"],u="/executions/[id]/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/executions/[id]/page",pathname:"/executions/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8693:(e,t,r)=>{Promise.resolve().then(r.bind(r,7816))},7816:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(2295),a=r(3729),n=r(2254),c=r(4418),o=r(8955),i=r(5945);function l({execution:e}){return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["Execution #",e.id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Type: ",s.jsx("span",{className:"capitalize",children:e.execution_type})]})]}),s.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded border ${(e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"running":return"bg-blue-100 text-blue-800 border-blue-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"cancelled":default:return"bg-gray-100 text-gray-800 border-gray-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200"}})(e.status)}`,children:e.status})]}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Started"}),s.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900",children:e.started_at?new Date(e.started_at).toLocaleString():"Not started"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Completed"}),s.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900",children:e.completed_at?new Date(e.completed_at).toLocaleString():"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Duration"}),s.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900",children:e.started_at&&e.completed_at?`${Math.round((new Date(e.completed_at).getTime()-new Date(e.started_at).getTime())/1e3)}s`:"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Created"}),s.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900",children:new Date(e.created_at).toLocaleString()})]})]})]}),e.input_data&&Object.keys(e.input_data).length>0&&(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Input Data"}),s.jsx("pre",{className:"bg-gray-50 rounded p-4 overflow-x-auto text-sm",children:JSON.stringify(e.input_data,null,2)})]}),e.output_data&&Object.keys(e.output_data).length>0&&(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Output Data"}),s.jsx("pre",{className:"bg-gray-50 rounded p-4 overflow-x-auto text-sm",children:JSON.stringify(e.output_data,null,2)})]}),e.error&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Error"}),s.jsx("p",{className:"text-sm text-red-800",children:e.error})]})]})}class d{constructor(e="http://localhost:8000"){this.eventSource=null,this.baseUrl=e}connect(e,t,r,s){let a=`${this.baseUrl}/api/v1/executions/${e}/stream`;return this.eventSource=new EventSource(a),this.eventSource.onmessage=e=>{try{let t=JSON.parse(e.data);r(t)}catch(e){console.error("Failed to parse SSE event:",e)}},this.eventSource.onerror=e=>{console.error("SSE error:",e),s&&s(e),this.disconnect()},this}disconnect(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}isConnected(){return null!==this.eventSource&&this.eventSource.readyState===EventSource.OPEN}}var u=r(7464);function x({executionId:e}){let{token:t}=(0,u.tN)(),[r,n]=(0,a.useState)([]),[c,o]=(0,a.useState)(!1),i=(0,a.useRef)(null),l=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!t)return;let r=new d;return l.current=r,r.connect(e,t,e=>{n(t=>[...t,e]),o(!0)},e=>{console.error("SSE error:",e),o(!1)}),()=>{r.disconnect()}},[e,t]),(0,a.useEffect)(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[r]);let x=e=>{switch(e){case"connected":return"\uD83D\uDD17";case"execution_started":return"▶️";case"node_started":return"⚙️";case"node_completed":return"✅";case"node_failed":return"❌";case"execution_completed":return"\uD83C\uDF89";case"execution_failed":return"\uD83D\uDCA5";case"execution_cancelled":return"\uD83D\uDED1";case"error":return"⚠️";default:return"\uD83D\uDCDD"}},m=e=>{switch(e){case"execution_completed":case"node_completed":return"text-green-800 bg-green-50 border-green-200";case"execution_failed":case"node_failed":case"error":return"text-red-800 bg-red-50 border-red-200";case"execution_started":case"node_started":return"text-blue-800 bg-blue-50 border-blue-200";case"execution_cancelled":return"text-gray-800 bg-gray-50 border-gray-200";default:return"text-gray-800 bg-white border-gray-200"}};return(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,s.jsxs)("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Live Execution Logs"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500":"bg-gray-300"}`}),s.jsx("span",{className:"text-sm text-gray-500",children:c?"Connected":"Disconnected"})]})]}),(0,s.jsxs)("div",{className:"p-6 max-h-96 overflow-y-auto space-y-2",children:[0===r.length?s.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"Waiting for execution events..."}):r.map((e,t)=>s.jsx("div",{className:`p-3 rounded border ${m(e.type)}`,children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-lg",children:x(e.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-sm font-medium capitalize",children:e.type.replace(/_/g," ")}),e.timestamp&&s.jsx("span",{className:"text-xs opacity-75",children:new Date(e.timestamp).toLocaleTimeString()})]}),e.node_id&&(0,s.jsxs)("p",{className:"text-xs mt-1 opacity-75",children:["Node: ",e.node_id," ",e.node_type&&`(${e.node_type})`]}),e.error&&s.jsx("p",{className:"text-sm mt-2 font-mono",children:e.error}),e.output&&s.jsx("pre",{className:"text-xs mt-2 overflow-x-auto",children:JSON.stringify(e.output,null,2)})]})]})},t)),s.jsx("div",{ref:i})]})]})}var m=r(5739);function g(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),r=Number(e.id),{getExecution:d,cancelExecution:u}=(0,m.r)(),[g,p]=(0,a.useState)(null),[h,b]=(0,a.useState)(!0),[f,y]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1),N=(0,a.useCallback)(async()=>{b(!0),y(null);try{let e=await d(r);p(e)}catch(e){y(e instanceof Error?e.message:"Failed to load execution"),console.error("Failed to load execution:",e)}finally{b(!1)}},[r,d]);(0,a.useEffect)(()=>{N()},[N]);let w=async()=>{if(g&&"running"===g.status){v(!0);try{await u(r),await N()}catch(e){console.error("Failed to cancel execution:",e)}finally{v(!1)}}};return h?s.jsx(c.Z,{children:(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[s.jsx(o.Z,{}),s.jsx("div",{className:"flex-1 overflow-auto",children:s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})]})}):!f&&(h||g)?s.jsx(c.Z,{children:(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[s.jsx(o.Z,{}),s.jsx("div",{className:"flex-1 overflow-auto",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[s.jsx(i.Z,{}),(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>t.back(),className:"text-gray-600 hover:text-gray-900 flex items-center gap-2",children:"← Back"}),"running"===g.status&&s.jsx("button",{onClick:w,disabled:j,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50",children:j?"Cancelling...":"Cancel Execution"})]}),s.jsx(l,{execution:g}),s.jsx("div",{className:"mt-6",children:s.jsx(x,{executionId:r})})]})})]})}):s.jsx(c.Z,{children:(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[s.jsx(o.Z,{}),s.jsx("div",{className:"flex-1 overflow-auto",children:s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md",children:[s.jsx("div",{className:"text-5xl mb-4",children:"⚠️"}),s.jsx("p",{className:"text-red-600 mb-4",children:f||"Execution not found"}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[s.jsx("button",{onClick:()=>N(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Retry"}),s.jsx("button",{onClick:()=>t.push("/executions"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Go to Executions"})]})]})})})]})})}},5739:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});var s=r(3729),a=r(6224);function n(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),i=(0,s.useCallback)(async()=>{n(!0),o(null);try{let e=await a.x.get("/api/v1/executions");if(e.error)throw Error(e.error);t(e.data?.executions||[])}catch(e){o(e instanceof Error?e.message:"Failed to fetch executions"),console.error("Failed to fetch executions:",e)}finally{n(!1)}},[]),l=async e=>{let t=await a.x.get(`/api/v1/executions/${e}`);if(t.error)throw Error(t.error);return t.data},d=async e=>{let t=await a.x.get(`/api/v1/executions/${e}/details`);if(t.error)throw Error(t.error);return t.data},u=async e=>{let t=await a.x.get(`/api/v1/executions/${e}/logs`);if(t.error)throw Error(t.error);return t.data?.logs||[]},x=async e=>{let r=await a.x.post(`/api/v1/executions/${e}/cancel`,{});if(r.error)throw Error(r.error);t(t=>t.map(t=>t.id===e?{...t,status:"cancelled"}:t))},m=async(e,r)=>{let s=await a.x.post(`/api/v1/flows/${e}/execute`,{inputs:r});if(s.error)throw Error(s.error);let n=s.data;return t(e=>[n,...e]),n};return(0,s.useEffect)(()=>{i()},[i]),{executions:e,loading:r,error:c,getExecution:l,getExecutionDetails:d,getExecutionLogs:u,cancelExecution:x,executeFlow:m,streamExecutionLogs:(e,t,r)=>{let s=new EventSource(`${a.x.baseURL}/api/v1/executions/${e}/logs/stream`);return s.onmessage=e=>{try{let r=JSON.parse(e.data);t(r)}catch(e){console.error("Failed to parse log event:",e)}},s.onerror=e=>{console.error("EventSource error:",e),r?.(Error("Log stream error")),s.close()},()=>{s.close()}},refetch:i}}},8460:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>c});let s=(0,r(6843).createProxy)(String.raw`/Users/blackghost/go/src/github.com/szaher/crewzx/crewz/frontend/src/app/executions/[id]/page.tsx`),{__esModule:a,$$typeof:n}=s,c=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[572,774,297,12],()=>r(5625));module.exports=s})();