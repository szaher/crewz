"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[67],{9755:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(7437),s=r(2265),o=r(4033),a=r(8541);function l(e){let{children:t,requiredRole:r}=e,l=(0,o.useRouter)(),i=(0,o.usePathname)(),{isAuthenticated:u,user:c}=(0,a.tN)(),[d,h]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=a.tN.persist.onFinishHydration(()=>{h(!0)});return a.tN.persist.hasHydrated()&&h(!0),()=>{e()}},[]),(0,s.useEffect)(()=>{if(d){if(!u){l.push("/login?redirect=".concat(encodeURIComponent(i)));return}if(r&&c){let e={viewer:0,member:1,admin:2};(e[c.role]||0)<(e[r]||0)&&l.push("/dashboard?error=unauthorized")}}},[d,u,c,r,l,i]),d&&u)?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}},8563:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(7437),s=r(4033),o=r(8541);function a(){let{sidebarOpen:e,toggleSidebar:t}=(0,o.HB)();return(0,n.jsx)("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center p-1 text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-pressed":e,"aria-label":e?"Hide menu":"Show menu",title:e?"Hide menu":"Show menu",children:e?(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5","aria-hidden":!0,children:[(0,n.jsx)("path",{d:"M13.5 19.5l-7.5-7.5 7.5-7.5"}),(0,n.jsx)("path",{d:"M19.5 19.5l-7.5-7.5 7.5-7.5"})]}):(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,n.jsx)("path",{d:"M3.75 6.75A.75.75 0 0 1 4.5 6h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75zm0 5.25a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75zm0 5.25a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75z"})})})}var l=r(2265),i=r(6312);function u(){var e;let t=(0,s.useRouter)(),{user:r,clearAuth:a}=(0,o.tN)(),{currentTenant:u}=(0,o.qT)(),[c,d]=(0,l.useState)(!1),h=(0,l.useRef)(null);return((0,l.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&d(!1)};return c&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[c]),r)?(0,n.jsxs)("div",{className:"relative",ref:h,children:[(0,n.jsxs)("button",{onClick:()=>d(!c),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 transition-colors w-full text-left","aria-expanded":c,"aria-haspopup":"true",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium",children:(null===(e=r.full_name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:r.full_name}),(0,n.jsx)("p",{className:"text-xs text-gray-500 truncate",children:r.email})]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform ".concat(c?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&(0,n.jsxs)("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden",children:[u&&(0,n.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Organization"}),(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:u.name})]}),(0,n.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200",children:[(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Role"}),(0,n.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium rounded bg-purple-100 text-purple-800",children:r.role})]}),(0,n.jsxs)("div",{className:"py-1",children:[(0,n.jsxs)("button",{onClick:()=>{t.push("/profile"),d(!1)},className:"w-full px-4 py-2 text-sm text-left text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile Settings"]}),(0,n.jsxs)("button",{onClick:()=>{t.push("/settings"),d(!1)},className:"w-full px-4 py-2 text-sm text-left text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[(0,n.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 py-1",children:(0,n.jsxs)("button",{onClick:()=>{a(),i.x.clearToken(),t.push("/login")},className:"w-full px-4 py-2 text-sm text-left text-red-600 hover:bg-red-50 flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})]}):null}function c(){let e=(0,s.useRouter)(),t=(0,s.usePathname)(),{currentTenant:r}=(0,o.qT)(),{user:l}=(0,o.tN)(),{sidebarOpen:i}=(0,o.HB)(),c=[{name:"Dashboard",path:"/dashboard",icon:"\uD83D\uDCCA"},{name:"Flows",path:"/flows",icon:"\uD83D\uDD00"},{name:"Crews",path:"/crews",icon:"\uD83D\uDC65"},{name:"Agents",path:"/agents",icon:"\uD83E\uDD16"},{name:"Providers",path:"/providers",icon:"\uD83D\uDD0C"},{name:"Tools",path:"/tools",icon:"\uD83D\uDD27"},{name:"Executions",path:"/executions",icon:"⚙️"},{name:"Observability",path:"/observability",icon:"\uD83D\uDCC8"},{name:"Chat",path:"/chat",icon:"\uD83D\uDCAC"},...(null==l?void 0:l.role)==="admin"?[{name:"Users",path:"/users",icon:"\uD83E\uDDD1‍\uD83E\uDD1D‍\uD83E\uDDD1"}]:[]],d=e=>null==t?void 0:t.startsWith(e);return i?(0,n.jsxs)("nav",{className:"bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 w-64 min-h-screen flex flex-col",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Automation Platform"}),r&&(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.name})]}),(0,n.jsx)(a,{})]}),(0,n.jsx)("div",{className:"flex-1 p-4 space-y-1",children:c.map(t=>(0,n.jsxs)("button",{onClick:()=>e.push(t.path),className:"\n              w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors\n              ".concat(d(t.path)?"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800","\n            "),children:[(0,n.jsx)("span",{className:"text-xl",children:t.icon}),(0,n.jsx)("span",{className:"text-sm",children:t.name})]},t.path))}),(0,n.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-800",children:(0,n.jsx)(u,{})})]}):(0,n.jsx)("nav",{className:"bg-white border-r border-gray-200 w-12 min-h-screen flex flex-col items-center py-3",children:(0,n.jsx)(a,{})})}},6312:function(e,t,r){r.d(t,{x:function(){return a}});let n="http://localhost:8000",s="http://localhost:8000";{let e="".concat(window.location.protocol,"//").concat(window.location.hostname,":8000");n=s&&!/^(https?:\/\/)?(localhost|127\.0\.0\.1)(:|$)/i.test(s)?s:e}class o{setUnauthorizedHandler(e){this.onUnauthorized=e}setToken(e){this.token=e,localStorage.setItem("access_token",e)}clearToken(){this.token=null,localStorage.removeItem("access_token")}getToken(){return this.token}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:r="GET",body:n,headers:s={},skipAuth:o=!1}=t,a="".concat(this.baseUrl).concat(e),l={"Content-Type":"application/json",...s};!o&&this.token&&(l.Authorization="Bearer ".concat(this.token));let i={method:r,headers:l};n&&"GET"!==r&&(i.body=JSON.stringify(n));try{let e=await fetch(a,i),t=e.headers.get("content-type")||"",r=204===e.status||205===e.status||"0"===e.headers.get("content-length"),n=null;if(!r){if(t.includes("application/json"))try{n=await e.json()}catch(e){n=null}else try{n=await e.text()||null}catch(e){n=null}}if(!e.ok)return 401===e.status&&!o&&(this.clearToken(),this.onUnauthorized&&this.onUnauthorized()),{error:"string"==typeof n&&n||(null==n?void 0:n.detail)||(null==n?void 0:n.message)||"Request failed",status:e.status};return{data:n,status:e.status}}catch(e){return{error:e instanceof Error?e.message:"Network error",status:0}}}async get(e,t){return this.request(e,{...t,method:"GET"})}async post(e,t,r){return this.request(e,{...r,method:"POST",body:t})}async put(e,t,r){return this.request(e,{...r,method:"PUT",body:t})}async delete(e,t){return this.request(e,{...t,method:"DELETE"})}constructor(e=n){this.token=null,this.onUnauthorized=null,this.baseUrl=e,this.token=localStorage.getItem("access_token")}}let a=new o},8541:function(e,t,r){r.d(t,{EW:function(){return i},Ge:function(){return l},HB:function(){return h},eb:function(){return u},f0:function(){return d},nL:function(){return c},qT:function(){return a},tN:function(){return o}});var n=r(4738),s=r(4810);let o=(0,n.Ue)()((0,s.tJ)(e=>({user:null,token:null,isAuthenticated:!1,setAuth:(t,r)=>e({user:t,token:r,isAuthenticated:!0}),clearAuth:()=>e({user:null,token:null,isAuthenticated:!1})}),{name:"auth-storage"})),a=(0,n.Ue)()((0,s.tJ)(e=>({currentTenant:null,setTenant:t=>e({currentTenant:t}),clearTenant:()=>e({currentTenant:null})}),{name:"tenant-storage"})),l=(0,n.Ue)(e=>({flows:[],currentFlow:null,setFlows:t=>e({flows:t}),setCurrentFlow:t=>e({currentFlow:t}),addFlow:t=>e(e=>({flows:[...e.flows,t]})),updateFlow:(t,r)=>e(e=>{var n;return{flows:e.flows.map(e=>e.id===t?{...e,...r}:e),currentFlow:(null===(n=e.currentFlow)||void 0===n?void 0:n.id)===t?{...e.currentFlow,...r}:e.currentFlow}}),deleteFlow:t=>e(e=>{var r;return{flows:e.flows.filter(e=>e.id!==t),currentFlow:(null===(r=e.currentFlow)||void 0===r?void 0:r.id)===t?null:e.currentFlow}})})),i=(0,n.Ue)(e=>({agents:[],setAgents:t=>e({agents:t}),addAgent:t=>e(e=>({agents:[...e.agents,t]})),updateAgent:(t,r)=>e(e=>({agents:e.agents.map(e=>e.id===t?{...e,...r}:e)})),deleteAgent:t=>e(e=>({agents:e.agents.filter(e=>e.id!==t)}))})),u=(0,n.Ue)(e=>({crews:[],setCrews:t=>e({crews:t}),addCrew:t=>e(e=>({crews:[...e.crews,t]})),updateCrew:(t,r)=>e(e=>({crews:e.crews.map(e=>e.id===t?{...e,...r}:e)})),deleteCrew:t=>e(e=>({crews:e.crews.filter(e=>e.id!==t)}))})),c=(0,n.Ue)(e=>({tools:[],setTools:t=>e({tools:t}),addTool:t=>e(e=>({tools:[...e.tools,t]})),updateTool:(t,r)=>e(e=>({tools:e.tools.map(e=>e.id===t?{...e,...r}:e)})),deleteTool:t=>e(e=>({tools:e.tools.filter(e=>e.id!==t)}))})),d=(0,n.Ue)(e=>({executions:[],currentExecution:null,setExecutions:t=>e({executions:t}),setCurrentExecution:t=>e({currentExecution:t}),addExecution:t=>e(e=>({executions:[...e.executions,t]})),updateExecution:(t,r)=>e(e=>{var n;return{executions:e.executions.map(e=>e.id===t?{...e,...r}:e),currentExecution:(null===(n=e.currentExecution)||void 0===n?void 0:n.id)===t?{...e.currentExecution,...r}:e.currentExecution}})})),h=(0,n.Ue)()((0,s.tJ)(e=>({sidebarOpen:!0,theme:"system",toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setTheme:t=>e({theme:t})}),{name:"ui-storage"}))}}]);