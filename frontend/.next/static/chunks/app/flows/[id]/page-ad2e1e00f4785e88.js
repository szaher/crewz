(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{1791:function(e,t,r){Promise.resolve().then(r.bind(r,4272))},4272:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return H}});var a=r(7437),s=r(2265),l=r(4033),n=r(9755),o=r(8563),d=r(6816),i=r(105),c=r(1611),u=r(3774);r(7333);var x=r(8541),m=(0,s.memo)(function(e){var t;let{data:r,selected:s}=e;return(0,a.jsxs)("div",{className:"\n        px-4 py-3 shadow-lg rounded-2xl border-2 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-blue-600 ring-2 ring-blue-200":"border-gray-400 dark:border-gray-600","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsx)(d.HH,{type:"target",position:d.Ly.Top,className:"w-4 h-4 bg-gray-500 border-2 border-white shadow-md"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:r.label||"Agent"}),r.agent_id&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["ID: ",r.agent_id]})]})]}),r.config&&Object.keys(r.config).length>0&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:[Object.keys(r.config).length," config(s)"]}),(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,className:"w-4 h-4 bg-gray-500 border-2 border-white shadow-md"})]})}),p=(0,s.memo)(function(e){var t;let{data:r,selected:s}=e;return(0,a.jsxs)("div",{className:"\n        px-4 py-3 shadow-lg rounded-2xl border-2 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-900/10 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-purple-600 ring-2 ring-purple-200":"border-purple-400 dark:border-purple-700","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsx)(d.HH,{type:"target",position:d.Ly.Top,className:"w-4 h-4 bg-purple-500 border-2 border-white shadow-md"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD27"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:r.label||"Tool"}),r.tool_id&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["ID: ",r.tool_id]})]})]}),r.inputs&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:[Object.keys(r.inputs).length," input(s)"]}),(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,className:"w-4 h-4 bg-purple-500 border-2 border-white shadow-md"})]})}),b=(0,s.memo)(function(e){var t;let{data:r,selected:s}=e;return(0,a.jsxs)("div",{className:"\n        px-4 py-3 shadow-lg rounded-2xl border-2 bg-gradient-to-br from-green-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-900/10 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-green-600 ring-2 ring-green-200":"border-green-400 dark:border-green-700","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsx)(d.HH,{type:"target",position:d.Ly.Top,className:"w-4 h-4 bg-green-500 border-2 border-white shadow-md"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDDE0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:r.label||"LLM"}),r.llm_provider_id&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Provider: ",r.llm_provider_id]})]})]}),r.prompt&&(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-600 truncate",children:r.prompt}),(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,className:"w-4 h-4 bg-green-500 border-2 border-white shadow-md"})]})}),g=(0,s.memo)(function(e){var t;let{data:r,selected:s}=e;return(0,a.jsxs)("div",{className:"\n        px-4 py-3 shadow-lg rounded-2xl border-2 bg-gradient-to-br from-yellow-50 to-amber-100 dark:from-amber-900/20 dark:to-amber-900/10 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-yellow-600 ring-2 ring-yellow-200":"border-yellow-400 dark:border-amber-700","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsx)(d.HH,{type:"target",position:d.Ly.Top,className:"w-4 h-4 bg-yellow-500 border-2 border-white shadow-md"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD00"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:r.label||"Condition"})})]}),r.expression&&(0,a.jsx)("div",{className:"mt-2 text-xs font-mono text-gray-600 truncate",children:r.expression}),(0,a.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,id:"true",className:"w-4 h-4 bg-green-500 border-2 border-white shadow-md",style:{left:"30%"}}),(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,id:"false",className:"w-4 h-4 bg-red-500 border-2 border-white shadow-md",style:{left:"70%"}})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{className:"ml-2",children:"True"}),(0,a.jsx)("span",{className:"mr-2",children:"False"})]})]})});let h={agent:m,tool:p,llm:b,condition:g,crew:m,input:(0,s.memo)(function(e){var t;let{data:r,selected:s}=e,l=r.inputs||[];return(0,a.jsxs)("div",{className:"\n        relative shadow-lg rounded-2xl border-2 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/10 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-blue-600 ring-2 ring-blue-200":"border-blue-400 dark:border-blue-700","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-500 rounded-full p-2 flex items-center justify-center w-10 h-10 flex-shrink-0",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCE5"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"font-bold text-gray-900 text-sm uppercase tracking-wide truncate",children:r.label||"Flow Input"})})]}),r.description&&(0,a.jsx)("div",{className:"text-xs text-gray-600 italic leading-relaxed",children:r.description}),l.length>0?(0,a.jsxs)("div",{className:"bg-white/50 rounded-lg p-3 border border-blue-200",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:"Input Variables:"}),(0,a.jsx)("div",{className:"space-y-1.5",children:l.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("span",{className:"text-blue-600 font-mono",children:"•"}),(0,a.jsx)("span",{className:"font-medium text-gray-700 truncate flex-1",children:e.name||"input_".concat(t)}),e.type&&(0,a.jsxs)("span",{className:"text-gray-500 text-[10px] flex-shrink-0",children:["(",e.type,")"]})]},t))})]}):(0,a.jsx)("div",{className:"text-xs text-gray-500 bg-white/30 rounded-lg p-3 text-center",children:"No inputs configured"})]}),(0,a.jsx)(d.HH,{type:"source",position:d.Ly.Bottom,className:"w-10 h-10 bg-blue-500 border-2 border-white shadow-md rounded-full"})]})}),output:(0,s.memo)(function(e){var t;let{data:r,selected:s}=e,l=r.outputs||[];return(0,a.jsxs)("div",{className:"\n        relative shadow-lg rounded-2xl border-2 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-emerald-900/10 dark:to-emerald-900/5 min-w-[260px] max-w-none overflow-auto ".concat((null==r?void 0:null===(t=r.__ui)||void 0===t?void 0:t.readOnly)?"":"resize-x","\n        ").concat(s?"border-green-600 ring-2 ring-green-200":"border-green-400 dark:border-green-700","\n      "),style:(null==r?void 0:r.width)?{width:r.width}:void 0,children:[(0,a.jsx)(d.HH,{type:"target",position:d.Ly.Top,className:"w-10 h-10 bg-green-500 border-2 border-white shadow-md rounded-full"}),(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-green-500 rounded-full p-2 flex items-center justify-center w-10 h-10 flex-shrink-0",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCE4"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"font-bold text-gray-900 text-sm uppercase tracking-wide truncate",children:r.label||"Flow Output"})})]}),r.description&&(0,a.jsx)("div",{className:"text-xs text-gray-600 italic leading-relaxed",children:r.description}),l.length>0?(0,a.jsxs)("div",{className:"bg-white/50 rounded-lg p-3 border border-green-200",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-green-700 mb-2",children:"Output Variables:"}),(0,a.jsx)("div",{className:"space-y-1.5",children:l.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("span",{className:"text-green-600 font-mono",children:"•"}),(0,a.jsx)("span",{className:"font-medium text-gray-700 truncate flex-1",children:e.name||"output_".concat(t)}),e.type&&(0,a.jsxs)("span",{className:"text-gray-500 text-[10px] flex-shrink-0",children:["(",e.type,")"]})]},t))})]}):(0,a.jsx)("div",{className:"text-xs text-gray-500 bg-white/30 rounded-lg p-3 text-center",children:"No outputs configured"})]})]})}),decision:g},f={default:function(e){let{id:t,sourceX:r,sourceY:s,targetX:l,targetY:n,sourcePosition:o,targetPosition:i,style:c={},markerEnd:u,data:x}=e,[m,p,b]=(0,d.OQ)({sourceX:r,sourceY:s,sourcePosition:o,targetX:l,targetY:n,targetPosition:i});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{id:t,style:c,className:"react-flow__edge-path",d:m,markerEnd:u}),(0,a.jsx)("foreignObject",{width:20,height:20,x:p-10,y:b-10,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,a.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,a.jsx)("button",{className:"w-5 h-5 bg-red-500 text-white rounded-full text-xs font-bold hover:bg-red-600 flex items-center justify-center shadow-md cursor-pointer border border-white",onClick:e=>{var r;e.stopPropagation(),null==x||null===(r=x.onDelete)||void 0===r||r.call(x,t)},title:"Delete connection",children:"\xd7"})})})]})}};function y(e){let{flowId:t,readOnly:r=!1,onNodeSelect:l}=e,{currentFlow:n,updateFlow:o}=(0,x.Ge)(),m=(0,s.useRef)(null),{screenToFlowPosition:p}=(0,d._K)(),b=(0,s.useRef)(1),g=(0,s.useCallback)(e=>e.map(e=>{var t;let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.width,s=a?{width:a}:void 0,l={...e.data,__ui:{readOnly:r}};return{id:e.id,type:e.type,position:e.position,data:l,...s?{style:s}:{}}}),[r]),y=(0,s.useCallback)(e=>e.map(e=>({id:e.id,source:e.source,target:e.target,type:e.type||"default",data:e.data})),[]),[v,j,N]=(0,d.Rr)(n?g(n.nodes):[]),[w,k,C]=(0,d.ll)(n?y(n.edges||[]):[]),_=(0,s.useCallback)(e=>{k(t=>t.filter(t=>t.id!==e))},[k]);(0,s.useEffect)(()=>{n&&n.nodes&&(j(g(n.nodes)),k(y(n.edges||[]).map(e=>({...e,data:{...e.data,onDelete:_}}))))},[y,g,n,_,k,j]),(0,s.useEffect)(()=>{let e=e=>{if(!r&&("Delete"===e.key||"Backspace"===e.key)){let t=w.some(e=>e.selected),r=v.some(e=>e.selected);if((t||r)&&e.preventDefault(),t&&k(e=>e.filter(e=>!e.selected)),r){let e=new Set(v.filter(e=>e.selected).map(e=>e.id));j(e=>e.filter(e=>!e.selected)),k(t=>t.filter(t=>!e.has(t.source)&&!e.has(t.target))),null==l||l(null)}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[w,v,r,k,j,l]),(0,s.useEffect)(()=>{if(!n||r)return;let e=setTimeout(()=>{let e=v.map(e=>{var t;let r=e.width,a=null===(t=e.style)||void 0===t?void 0:t.width,s=null!=r?r:a,l={...e.data};return l&&l.__ui&&delete l.__ui,s&&(l.width=s),{id:e.id,type:e.type,position:e.position,data:l}}),t=w.map(e=>({id:e.id,source:e.source,target:e.target,type:e.type,data:e.data})),r=JSON.stringify(e)!==JSON.stringify(n.nodes),a=JSON.stringify(t)!==JSON.stringify(n.edges);(r||a)&&o(n.id,{nodes:e,edges:t})},300);return()=>clearTimeout(e)},[n,w,v,r,o]);let D=(0,s.useCallback)(e=>{if(!e.source||!e.target)return!1;let t=v.find(t=>t.id===e.source),r=v.find(t=>t.id===e.target);return!!t&&!!r&&("input"!==t.type||"output"!==r.type)},[v]),S=(0,s.useCallback)(e=>{if(!r){if(!D(e)){alert("Invalid connection: Input nodes cannot connect directly to Output nodes.");return}k(t=>(0,d.Z_)({...e,data:{onDelete:_}},t))}},[r,D,k,_]),E=(0,s.useCallback)(e=>{r||N(e)},[r,N]),L=(0,s.useCallback)(e=>{r||C(e)},[r,C]),O=(0,s.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),F=(0,s.useCallback)(e=>{if(e.preventDefault(),r)return;let t=e.dataTransfer.getData("application/reactflow");if(!t)return;let a=p({x:e.clientX,y:e.clientY}),s={label:"".concat(t.charAt(0).toUpperCase()+t.slice(1)," Node")};"input"===t?s={label:"Flow Input",description:"Define input variables for this flow",inputs:[{name:"input_1",type:"string",required:!0}],width:300}:"output"===t&&(s={label:"Flow Output",description:"Define output variables from this flow",outputs:[{name:"result",type:"string"}]});let n="input"===t?300:260;s={...s,width:n};let o={id:"node_".concat(b.current++),type:t,position:a,data:s,style:{width:n}};j(e=>e.concat(o)),null==l||l(o)},[r,p,j,l]),A=(0,s.useCallback)((e,t)=>{r||null==l||l(t)},[r,l]),I=(0,s.useCallback)(()=>{null==l||l(null)},[l]);return(0,a.jsx)("div",{ref:m,className:"w-full h-full",children:(0,a.jsxs)(d.x$,{nodes:v,edges:w,nodeTypes:h,edgeTypes:f,onNodesChange:E,onEdgesChange:L,onConnect:S,onDrop:F,onDragOver:O,onNodeClick:A,onPaneClick:I,fitView:!0,nodesDraggable:!r,nodesConnectable:!r,elementsSelectable:!r,deleteKeyCode:null,children:[(0,a.jsx)(i.A,{}),(0,a.jsx)(c.Z,{}),(0,a.jsx)(u.a,{})]})})}function v(e){return(0,a.jsx)(d.tV,{children:(0,a.jsx)(y,{...e})})}var j=r(6312),N=r(88);function w(e){let{flowId:t,initialName:r,onUpdate:l}=e,{updateFlow:n}=(0,N.w)(),[o,d]=(0,s.useState)(!1),[i,c]=(0,s.useState)(r),[u,x]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{c(r)},[r]),(0,s.useEffect)(()=>{o&&b.current&&(b.current.focus(),b.current.select())},[o]);let g=async()=>{let e=i.trim();if(!e){p("Name cannot be empty");return}if(e===r){d(!1);return}x(!0),p(null);try{await n(t,{name:e}),d(!1),l&&l(e)}catch(e){p(e instanceof Error?e.message:"Failed to update flow name"),console.error("Flow name update error:",e)}finally{x(!1)}},h=()=>{c(r),p(null),d(!1)};return o?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{ref:b,type:"text",value:i,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),g()):"Escape"===e.key&&(e.preventDefault(),h())},onBlur:g,disabled:u,className:"text-lg font-semibold text-gray-900 border-2 border-blue-500 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Flow name..."}),u&&(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-blue-600",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}),m&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:m}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Press Enter to save, Escape to cancel"})]}):(0,a.jsxs)("div",{onClick:()=>d(!0),className:"group flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:i}),(0,a.jsx)("button",{className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-opacity",title:"Edit flow name",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}var k=r(9222);function C(e){let{isOpen:t,onClose:r,onExecute:l,inputVariables:n,flowName:o}=e,[d,i]=(0,s.useState)({}),[c,u]=(0,s.useState)({});(0,s.useEffect)(()=>{let e={};n.forEach(t=>{e[t.name]=""}),i(e),u({})},[n,t]);let x=(e,t,r)=>{let a=t;try{"number"===r?a=t?parseFloat(t):"":"boolean"===r?a="true"===t:("object"===r||"array"===r)&&(a=t.trim()?JSON.parse(t):"array"===r?[]:{}),i(t=>({...t,[e]:a})),u(t=>{let r={...t};return delete r[e],r})}catch(t){u(t=>({...t,[e]:"Invalid JSON format"}))}},m=()=>{let e={};return n.forEach(t=>{if(t.required){let r=d[t.name];(""===r||null==r)&&(e[t.name]="This field is required")}}),u(e),0===Object.keys(e).length};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:r}),(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full p-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Execute Flow",o?": ".concat(o):""]}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n.length>0?"Provide input values for the flow execution":"This flow has no input variables. Click Execute to start."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!m())return;let t={};Object.entries(d).forEach(e=>{let[r,a]=e;""!==a&&null!=a&&(t[r]=a)}),l(t)},children:[n.length>0&&(0,a.jsx)("div",{className:"space-y-4 mb-6 max-h-96 overflow-y-auto",children:n.map(e=>{var t;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"input-".concat(e.name),className:"block text-sm font-medium text-gray-700 mb-1",children:[e.name,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),e.type&&(0,a.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",e.type,")"]})]}),"boolean"===e.type?(0,a.jsxs)("select",{id:"input-".concat(e.name),value:(null===(t=d[e.name])||void 0===t?void 0:t.toString())||"",onChange:t=>x(e.name,t.target.value,e.type),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select..."}),(0,a.jsx)("option",{value:"true",children:"True"}),(0,a.jsx)("option",{value:"false",children:"False"})]}):"object"===e.type||"array"===e.type?(0,a.jsx)("textarea",{id:"input-".concat(e.name),value:"object"==typeof d[e.name]?JSON.stringify(d[e.name],null,2):d[e.name]||"",onChange:t=>x(e.name,t.target.value,e.type),rows:4,placeholder:"array"===e.type?'["item1", "item2"]':'{"key": "value"}',className:"w-full px-3 py-2 border rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(c[e.name]?"border-red-300 bg-red-50":"border-gray-300")}):(0,a.jsx)("input",{id:"input-".concat(e.name),type:"number"===e.type?"number":"text",value:d[e.name]||"",onChange:t=>x(e.name,t.target.value,e.type),placeholder:"Enter ".concat(e.name,"..."),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(c[e.name]?"border-red-300 bg-red-50":"border-gray-300")}),c[e.name]&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c[e.name]})]},e.name)})}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Execute Flow"})]})]})]})})]}):null}function _(e){let{flowId:t,onSave:r,onExecute:n,onDiscard:o,onOpenProperties:d}=e,i=(0,l.useRouter)(),{currentFlow:c,updateFlow:u}=(0,x.Ge)(),[m,p]=(0,s.useState)(!1),[b,g]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),y=async()=>{if(c){p(!0);try{let e={name:c.name,description:c.description,nodes:c.nodes,edges:c.edges},t=await j.x.put("/api/v1/flows/".concat(c.id),e);t.error?alert("Save failed: ".concat(t.error)):(null==r||r(),i.push("/flows"))}catch(e){console.error("Save error:",e),alert("Failed to save flow")}finally{p(!1)}}},v=async e=>{if(c){g(!0),f(!1);try{let t=await j.x.post("/api/v1/flows/".concat(c.id,"/execute"),{inputs:e});t.error?alert("Execution failed: ".concat(t.error)):t.data&&(i.push("/executions/".concat(t.data.execution_id)),null==n||n())}catch(e){console.error("Execution error:",e),alert("Failed to execute flow")}finally{g(!1)}}},N=async()=>{if(c)try{let e=await j.x.post("/api/v1/flows/".concat(c.id,"/validate"),{nodes:c.nodes,edges:c.edges});e.error?alert("Validation failed: ".concat(e.error)):e.data&&(e.data.valid?alert("Flow is valid!"):alert("Validation errors:\n".concat(e.data.errors.join("\n"))))}catch(e){console.error("Validation error:",e),alert("Failed to validate flow")}};return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-4 py-3",children:[(0,a.jsx)(k.Z,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[c&&t?(0,a.jsx)(w,{flowId:t,initialName:c.name,onUpdate:e=>{c&&u(c.id,{name:e})}}):(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:(null==c?void 0:c.name)||"Untitled Flow"}),(null==c?void 0:c.status)&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:c.status})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center gap-2",title:"Flow Properties",children:[(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Properties"]}),(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to delete this workflow? This action cannot be undone.")&&(null==o||o())},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"}),(0,a.jsx)("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Validate"}),(0,a.jsx)("button",{onClick:y,disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Saving...":"Save"}),(0,a.jsx)("button",{onClick:()=>f(!0),disabled:b,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Executing...":"Execute"})]})]}),(0,a.jsx)(C,{isOpen:h,onClose:()=>f(!1),onExecute:v,inputVariables:(()=>{if(!c)return[];let e=c.nodes.filter(e=>"input"===e.type),t=[];return e.forEach(e=>{e.data.inputs&&Array.isArray(e.data.inputs)&&t.push(...e.data.inputs)}),t})(),flowName:null==c?void 0:c.name})]})}let D=[{type:"agent",label:"Agent",icon:"\uD83E\uDD16",description:"AI agent node"},{type:"crew",label:"Crew",icon:"\uD83D\uDC65",description:"Agent crew node"},{type:"tool",label:"Tool",icon:"\uD83D\uDD27",description:"Tool execution node"},{type:"input",label:"Input",icon:"\uD83D\uDCE5",description:"Flow input node"},{type:"output",label:"Output",icon:"\uD83D\uDCE4",description:"Flow output node"},{type:"decision",label:"Decision",icon:"\uD83D\uDD00",description:"Conditional branch"}];function S(){let e=(e,t)=>{e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.effectAllowed="move"};return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 p-4 w-64 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Node Palette"}),(0,a.jsx)("div",{className:"space-y-2",children:D.map(t=>(0,a.jsxs)("div",{draggable:!0,onDragStart:r=>e(r,t.type),className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 cursor-move hover:bg-gray-100 dark:hover:bg-gray-700 hover:border-blue-300 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:t.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100 text-sm",children:t.label}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.description})]})]},t.type))}),(0,a.jsx)("div",{className:"mt-6 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-800/50",children:(0,a.jsx)("p",{className:"text-xs text-blue-800 dark:text-blue-300",children:"Drag nodes onto the canvas to build your flow. Connect them to create a workflow."})})]})}function E(e){var t,r;let{selectedNode:l,onUpdateNode:n,onClearSelection:o}=e,{agents:d,addAgent:i}=(0,x.EW)(),{crews:c}=(0,x.eb)(),{tools:u}=(0,x.nL)(),{currentFlow:m,updateFlow:p}=(0,x.Ge)(),[b,g]=(0,s.useState)({}),[h,f]=(0,s.useState)(!1),[y,v]=(0,s.useState)(!1),[N,w]=(0,s.useState)([]);(0,s.useEffect)(()=>{l&&g(l.data||{})},[l]);let k=async()=>{try{var e;let t=await j.x.get("/api/v1/llm-providers");w((null===(e=t.data)||void 0===e?void 0:e.providers)||[])}catch(e){console.error("Failed to load LLM providers:",e)}};if((0,s.useEffect)(()=>{k()},[]),!l)return(0,a.jsx)("div",{className:"bg-white border-l border-gray-200 p-4 w-80",children:(0,a.jsx)("div",{className:"text-center text-gray-500 mt-8",children:(0,a.jsx)("p",{className:"text-sm",children:"Select a node to view properties"})})});let C=(e,t)=>{let r={...b,[e]:t};g(r),n(l.id,r)},_=(null==l?void 0:l.type)==="input"?300:260,D=null!==(r="number"==typeof b.width?b.width:null==l?void 0:null===(t=l.style)||void 0===t?void 0:t.width)&&void 0!==r?r:_,S=async e=>{try{let t=(await j.x.post("/api/v1/agents",e)).data;i(t),C("agent_id",t.id),f(!1)}catch(e){var t,r;console.error("Failed to create agent:",e),alert("Failed to create agent: "+((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||e.message||"Unknown error"))}},E=async e=>{var t,r,a;try{let r=await j.x.post("/api/v1/llm-providers",e);(null===(t=r.data)||void 0===t?void 0:t.provider)||r.data,await k(),v(!1),alert("LLM Provider created successfully!")}catch(e){console.error("Failed to create LLM provider:",e),alert("Failed to create LLM provider: "+((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.detail)||e.message||"Unknown error"))}};return(0,a.jsxs)("div",{className:"bg-white border-l border-gray-200 p-4 w-80 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Node Properties"}),(0,a.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Type: ",(0,a.jsx)("span",{className:"text-blue-600",children:l.type})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["ID: ",l.id]})]}),(0,a.jsx)("button",{onClick:()=>{if(!m||!l||!confirm("Delete this node? Connected edges will be removed."))return;let e=l.id,t=(m.nodes||[]).filter(t=>t.id!==e),r=(m.edges||[]).filter(t=>t.source!==e&&t.target!==e);p(m.id,{nodes:t,edges:r}),null==o||o()},className:"inline-flex items-center justify-center text-xs px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700",title:"Delete node","aria-label":"Delete node",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,a.jsx)("path",{d:"M9 3a1 1 0 0 0-1 1v1H5.5a1 1 0 1 0 0 2H6v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7h.5a1 1 0 1 0 0-2H16V4a1 1 0 0 0-1-1H9zm2 4a1 1 0 1 0-2 0v10a1 1 0 1 0 2 0V7zm4 0a1 1 0 1 0-2 0v10a1 1 0 1 0 2 0V7zM9 5h6v1H9V5z"})})})]})}),(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Width: ",(0,a.jsxs)("span",{className:"text-gray-600",children:[D,"px"]})]}),(0,a.jsx)("input",{type:"range",min:260,max:1e3,step:10,value:D,onChange:e=>C("width",parseInt(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-[10px] text-gray-500 mt-1",children:[(0,a.jsxs)("span",{children:[260,"px"]}),(0,a.jsxs)("span",{children:[1e3,"px"]})]})]}),"agent"===l.type&&(()=>{let e=d.find(e=>e.id===b.agent_id);return h?y?(0,a.jsx)(O,{onSubmit:E,onCancel:()=>v(!1)}):(0,a.jsx)(L,{llmProviders:N,onSubmit:S,onCancel:()=>f(!1),onCreateProvider:()=>v(!0)}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Agent"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{value:b.agent_id||"",onChange:e=>C("agent_id",Number(e.target.value)),className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose an agent..."}),d.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",e.role]},e.id))]}),(0,a.jsx)("button",{onClick:()=>f(!0),className:"px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Create new agent",children:"+"})]})]}),e&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-sm",children:"Agent Details"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Role:"})," ",e.role]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Goal:"})," ",e.goal]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Backstory:"})," ",e.backstory]})]}),(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-700 text-xs mb-2",children:"Configuration"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Delegation:"}),(0,a.jsx)("span",{className:"ml-1",children:e.allow_delegation?"✓":"✗"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Verbose:"}),(0,a.jsx)("span",{className:"ml-1",children:e.verbose?"✓":"✗"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Cache:"}),(0,a.jsx)("span",{className:"ml-1",children:e.cache?"✓":"✗"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Max Iter:"}),(0,a.jsx)("span",{className:"ml-1",children:e.max_iter})]}),e.max_rpm&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Max RPM:"}),(0,a.jsx)("span",{className:"ml-1",children:e.max_rpm})]}),e.max_execution_time&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Max Time:"}),(0,a.jsxs)("span",{className:"ml-1",children:[e.max_execution_time,"s"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Code Exec:"}),(0,a.jsx)("span",{className:"ml-1",children:e.allow_code_execution?"✓":"✗"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Retry Limit:"}),(0,a.jsx)("span",{className:"ml-1",children:e.max_retry_limit})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Agent Node",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]})]})})(),"crew"===l.type&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Crew"}),(0,a.jsxs)("select",{value:b.crew_id||"",onChange:e=>C("crew_id",Number(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose a crew..."}),c.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Crew Node",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]})]}),"tool"===l.type&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Tool"}),(0,a.jsxs)("select",{value:b.tool_id||"",onChange:e=>C("tool_id",Number(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose a tool..."}),u.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Tool Node",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]})]}),"input"===l.type&&(()=>{let e=b.inputs||[],t=t=>{C("inputs",e.filter((e,r)=>r!==t))},r=(t,r,a)=>{let s=[...e];s[t]={...s[t],[r]:a},C("inputs",s)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Flow Input",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:b.description||"",onChange:e=>C("description",e.target.value),rows:2,placeholder:"Describe what inputs this flow expects...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Input Variables"}),(0,a.jsx)("button",{onClick:()=>{C("inputs",[...e,{name:"input_".concat(e.length+1),type:"string",required:!1}])},className:"text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add Input"})]}),(0,a.jsx)("div",{className:"space-y-2",children:e.map((e,s)=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:["Input ",s+1]}),(0,a.jsx)("button",{onClick:()=>t(s),className:"text-xs text-red-600 hover:text-red-800",children:"Remove"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"text",value:e.name||"",onChange:e=>r(s,"name",e.target.value),placeholder:"Variable name",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("select",{value:e.type||"string",onChange:e=>r(s,"type",e.target.value),className:"rounded border border-gray-300 px-2 py-1 text-xs",children:[(0,a.jsx)("option",{value:"string",children:"String"}),(0,a.jsx)("option",{value:"number",children:"Number"}),(0,a.jsx)("option",{value:"boolean",children:"Boolean"}),(0,a.jsx)("option",{value:"object",children:"Object"}),(0,a.jsx)("option",{value:"array",children:"Array"})]}),(0,a.jsxs)("label",{className:"flex items-center text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.required||!1,onChange:e=>r(s,"required",e.target.checked),className:"mr-1"}),"Required"]})]})]})]},s))}),0===e.length&&(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center py-4",children:'No input variables defined. Click "Add Input" to add one.'})]})]})})(),"output"===l.type&&(()=>{let e=b.outputs||[],t=t=>{C("outputs",e.filter((e,r)=>r!==t))},r=(t,r,a)=>{let s=[...e];s[t]={...s[t],[r]:a},C("outputs",s)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Flow Output",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:b.description||"",onChange:e=>C("description",e.target.value),rows:2,placeholder:"Describe what outputs this flow produces...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Output Variables"}),(0,a.jsx)("button",{onClick:()=>{C("outputs",[...e,{name:"output_".concat(e.length+1),type:"string"}])},className:"text-xs px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"+ Add Output"})]}),(0,a.jsx)("div",{className:"space-y-2",children:e.map((e,s)=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:["Output ",s+1]}),(0,a.jsx)("button",{onClick:()=>t(s),className:"text-xs text-red-600 hover:text-red-800",children:"Remove"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"text",value:e.name||"",onChange:e=>r(s,"name",e.target.value),placeholder:"Variable name",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs"}),(0,a.jsxs)("select",{value:e.type||"string",onChange:e=>r(s,"type",e.target.value),className:"w-full rounded border border-gray-300 px-2 py-1 text-xs",children:[(0,a.jsx)("option",{value:"string",children:"String"}),(0,a.jsx)("option",{value:"number",children:"Number"}),(0,a.jsx)("option",{value:"boolean",children:"Boolean"}),(0,a.jsx)("option",{value:"object",children:"Object"}),(0,a.jsx)("option",{value:"array",children:"Array"})]})]})]},s))}),0===e.length&&(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center py-4",children:'No output variables defined. Click "Add Output" to add one.'})]})]})})(),!["agent","crew","tool","input","output"].includes(l.type)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Label"}),(0,a.jsx)("input",{type:"text",value:b.label||"",onChange:e=>C("label",e.target.value),placeholder:"Node Label",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Configuration (JSON)"}),(0,a.jsx)("textarea",{value:JSON.stringify(b.config||{},null,2),onChange:e=>{try{let t=JSON.parse(e.target.value);C("config",t)}catch(e){}},rows:6,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm font-mono focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]})]})]})}function L(e){let{llmProviders:t,onSubmit:r,onCancel:l,onCreateProvider:n}=e,[o,d]=(0,s.useState)({name:"",role:"",goal:"",backstory:"",llm_provider_id:"",temperature:.7,max_tokens:"",allow_delegation:!0,verbose:!1,cache:!0,max_iter:15,max_rpm:"",max_execution_time:"",allow_code_execution:!1,respect_context_window:!0,max_retry_limit:2,tool_ids:[]}),i=(e,t)=>{d(r=>({...r,[e]:t}))};return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r({...o,llm_provider_id:Number(o.llm_provider_id),max_tokens:o.max_tokens?Number(o.max_tokens):void 0,max_rpm:o.max_rpm?Number(o.max_rpm):void 0,max_execution_time:o.max_execution_time?Number(o.max_execution_time):void 0})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Create New Agent"}),(0,a.jsx)("button",{type:"button",onClick:l,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:o.name,onChange:e=>i("name",e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,a.jsx)("input",{type:"text",required:!0,value:o.role,onChange:e=>i("role",e.target.value),placeholder:"e.g., Senior Data Analyst",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Goal *"}),(0,a.jsx)("textarea",{required:!0,value:o.goal,onChange:e=>i("goal",e.target.value),rows:2,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Backstory *"}),(0,a.jsx)("textarea",{required:!0,value:o.backstory,onChange:e=>i("backstory",e.target.value),rows:2,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LLM Provider *"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{required:!0,value:o.llm_provider_id,onChange:e=>i("llm_provider_id",e.target.value),className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select provider..."}),t.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.provider_type,")"]},e.id))]}),(0,a.jsx)("button",{type:"button",onClick:n,className:"px-3 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",title:"Create new LLM provider",children:"+"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temperature"}),(0,a.jsx)("input",{type:"number",step:"0.1",min:"0",max:"2",value:o.temperature,onChange:e=>i("temperature",parseFloat(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Iterations"}),(0,a.jsx)("input",{type:"number",min:"1",value:o.max_iter,onChange:e=>i("max_iter",parseInt(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retry Limit"}),(0,a.jsx)("input",{type:"number",min:"0",value:o.max_retry_limit,onChange:e=>i("max_retry_limit",parseInt(e.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:o.allow_delegation,onChange:e=>i("allow_delegation",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Allow Delegation"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:o.cache,onChange:e=>i("cache",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Enable Cache"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:o.verbose,onChange:e=>i("verbose",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Verbose Logging"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:o.allow_code_execution,onChange:e=>i("allow_code_execution",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Allow Code Execution"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Create Agent"})]})]})}function O(e){let{onSubmit:t,onCancel:r}=e,[l,n]=(0,s.useState)({name:"",provider_type:"openai",model_name:"",api_key:"",api_base:"",config:{},is_default:!1}),o=(e,t)=>{n(r=>({...r,[e]:t}))};return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({...l,api_key:l.api_key||void 0,api_base:l.api_base||void 0})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Create LLM Provider"}),(0,a.jsx)("button",{type:"button",onClick:r,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:l.name,onChange:e=>o("name",e.target.value),placeholder:"e.g., My OpenAI Provider",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider Type *"}),(0,a.jsxs)("select",{required:!0,value:l.provider_type,onChange:e=>o("provider_type",e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"openai",children:"OpenAI"}),(0,a.jsx)("option",{value:"anthropic",children:"Anthropic"}),(0,a.jsx)("option",{value:"ollama",children:"Ollama"}),(0,a.jsx)("option",{value:"vllm",children:"vLLM"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:l.model_name,onChange:e=>o("model_name",e.target.value),placeholder:"e.g., gpt-4, claude-3-opus-20240229",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Examples: gpt-4, gpt-3.5-turbo, claude-3-opus-20240229, llama2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Key"}),(0,a.jsx)("input",{type:"password",value:l.api_key,onChange:e=>o("api_key",e.target.value),placeholder:"sk-...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Optional for local models (Ollama, vLLM)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Base URL"}),(0,a.jsx)("input",{type:"text",value:l.api_base,onChange:e=>o("api_base",e.target.value),placeholder:"https://api.openai.com/v1",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Optional. For custom endpoints or local models."})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.is_default,onChange:e=>o("is_default",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Set as default provider"})]})}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Create Provider"})]})]})}var F=r(9102),A=r.n(F);function I(e){var t,r;let{flowId:l,initialData:n,isOpen:o,onClose:d}=e,{updateFlow:i}=(0,N.w)(),[c,u]=(0,s.useState)({name:n.name,description:n.description||"",variables:JSON.stringify(n.variables||{},null,2),timeout:n.timeout||3600,maxRetries:(null===(t=n.retry_policy)||void 0===t?void 0:t.max_retries)||0,retryDelay:(null===(r=n.retry_policy)||void 0===r?void 0:r.retry_delay)||60}),[x,m]=(0,s.useState)("general"),[p,b]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null),[f,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{var e,t;y(c.name!==n.name||c.description!==(n.description||"")||c.variables!==JSON.stringify(n.variables||{},null,2)||c.timeout!==(n.timeout||3600)||c.maxRetries!==((null===(e=n.retry_policy)||void 0===e?void 0:e.max_retries)||0)||c.retryDelay!==((null===(t=n.retry_policy)||void 0===t?void 0:t.retry_delay)||60))},[c,n]);let w=e=>{try{return JSON.parse(e),j(null),!0}catch(e){return j(e instanceof Error?e.message:"Invalid JSON"),!1}},k=async()=>{if(h(null),!w(c.variables)){m("variables");return}b(!0);try{let e=JSON.parse(c.variables);await i(l,{name:c.name,description:c.description,variables:e}),y(!1),d()}catch(e){h(e instanceof Error?e.message:"Failed to update flow")}finally{b(!1)}},C=()=>{f?confirm("You have unsaved changes. Are you sure you want to close?")&&d():d()};return o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onClick:C,className:"jsx-ec49a32add56c6d fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity"}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d fixed right-0 top-0 bottom-0 w-96 bg-white shadow-2xl z-50 flex flex-col animate-slide-in-right",children:[(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d flex items-center justify-between p-4 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"jsx-ec49a32add56c6d text-lg font-semibold text-gray-900",children:"Flow Properties"}),(0,a.jsx)("button",{onClick:C,title:"Close",className:"jsx-ec49a32add56c6d p-1 hover:bg-gray-100 rounded transition-colors",children:(0,a.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-ec49a32add56c6d w-5 h-5 text-gray-500",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12",className:"jsx-ec49a32add56c6d"})})})]}),(0,a.jsx)("div",{className:"jsx-ec49a32add56c6d flex border-b border-gray-200",children:[{id:"general",label:"General"},{id:"variables",label:"Variables"},{id:"settings",label:"Settings"},{id:"metadata",label:"Metadata"}].map(e=>(0,a.jsx)("button",{onClick:()=>m(e.id),className:"jsx-ec49a32add56c6d "+"flex-1 px-4 py-3 text-sm font-medium border-b-2 transition-colors ".concat(x===e.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"),children:e.label},e.id))}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d flex-1 overflow-y-auto p-4 space-y-4",children:["general"===x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-name",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,a.jsx)("input",{id:"flow-name",type:"text",value:c.name,onChange:e=>u({...c,name:e.target.value}),placeholder:"Flow name",className:"jsx-ec49a32add56c6d w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-description",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{id:"flow-description",value:c.description,onChange:e=>u({...c,description:e.target.value}),placeholder:"Describe this flow...",rows:3,className:"jsx-ec49a32add56c6d w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),"variables"===x&&(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-variables",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Variables (JSON)"}),(0,a.jsx)("textarea",{id:"flow-variables",value:c.variables,onChange:e=>{u({...c,variables:e.target.value}),w(e.target.value)},placeholder:'{"key": "value"}',rows:8,className:"jsx-ec49a32add56c6d "+"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm ".concat(v?"border-red-500":"border-gray-300")}),v&&(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d mt-2 text-sm text-red-600",children:v}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d mt-2 text-xs text-gray-500",children:"Define flow variables as JSON key-value pairs"})]}),"settings"===x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-timeout",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Timeout (seconds)"}),(0,a.jsx)("input",{id:"flow-timeout",type:"number",value:c.timeout,onChange:e=>u({...c,timeout:parseInt(e.target.value)||0}),min:"0",className:"jsx-ec49a32add56c6d w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d mt-1 text-xs text-gray-500",children:"Maximum execution time (0 = no limit)"})]}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-max-retries",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Max Retries"}),(0,a.jsx)("input",{id:"flow-max-retries",type:"number",value:c.maxRetries,onChange:e=>u({...c,maxRetries:parseInt(e.target.value)||0}),min:"0",max:"10",className:"jsx-ec49a32add56c6d w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d mt-1 text-xs text-gray-500",children:"Number of retry attempts on failure"})]}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{htmlFor:"flow-retry-delay",className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Retry Delay (seconds)"}),(0,a.jsx)("input",{id:"flow-retry-delay",type:"number",value:c.retryDelay,onChange:e=>u({...c,retryDelay:parseInt(e.target.value)||0}),min:"0",className:"jsx-ec49a32add56c6d w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d mt-1 text-xs text-gray-500",children:"Delay between retry attempts"})]})]}),"metadata"===x&&(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d space-y-3",children:[(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Flow ID"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d text-sm text-gray-900 font-mono",children:l})]}),n.version&&(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Version"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d text-sm text-gray-900",children:n.version})]}),n.created_at&&(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Created"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d text-sm text-gray-900",children:new Date(n.created_at).toLocaleString()})]}),n.updated_at&&(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d",children:[(0,a.jsx)("label",{className:"jsx-ec49a32add56c6d block text-sm font-medium text-gray-700 mb-1",children:"Last Updated"}),(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d text-sm text-gray-900",children:new Date(n.updated_at).toLocaleString()})]})]})]}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d p-4 border-t border-gray-200 bg-gray-50",children:[g&&(0,a.jsx)("div",{className:"jsx-ec49a32add56c6d mb-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsx)("p",{className:"jsx-ec49a32add56c6d text-sm text-red-600",children:g})}),(0,a.jsxs)("div",{className:"jsx-ec49a32add56c6d flex gap-3",children:[(0,a.jsx)("button",{onClick:C,disabled:p,className:"jsx-ec49a32add56c6d flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,a.jsxs)("button",{onClick:k,disabled:p||!f,className:"jsx-ec49a32add56c6d flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[p&&(0,a.jsxs)("svg",{viewBox:"0 0 24 24",className:"jsx-ec49a32add56c6d animate-spin h-4 w-4",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",className:"jsx-ec49a32add56c6d opacity-25"}),(0,a.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-ec49a32add56c6d opacity-75"})]}),p?"Saving...":"Save Changes"]})]})]})]}),(0,a.jsx)(A(),{id:"ec49a32add56c6d",children:"@-webkit-keyframes slide-in-right{from{-webkit-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);transform:translatex(0)}}@-moz-keyframes slide-in-right{from{-moz-transform:translatex(100%);transform:translatex(100%)}to{-moz-transform:translatex(0);transform:translatex(0)}}@-o-keyframes slide-in-right{from{-o-transform:translatex(100%);transform:translatex(100%)}to{-o-transform:translatex(0);transform:translatex(0)}}@keyframes slide-in-right{from{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}}.animate-slide-in-right.jsx-ec49a32add56c6d{-webkit-animation:slide-in-right.3s ease-out;-moz-animation:slide-in-right.3s ease-out;-o-animation:slide-in-right.3s ease-out;animation:slide-in-right.3s ease-out}"})]}):null}function H(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),r="new"===e.id,d=!r&&e.id?Number(e.id):null,{setCurrentFlow:i,currentFlow:c}=(0,x.Ge)(),[u,m]=(0,s.useState)(null),[p,b]=(0,s.useState)(!0),[g,h]=(0,s.useState)(!1),[f,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(r&&!g){h(!0),(async()=>{try{var e;let r=await j.x.post("/api/v1/flows",{name:"New Flow",description:"A new workflow",nodes:[],edges:[],tags:[]}),a=(null===(e=r.data)||void 0===e?void 0:e.id)||r.id;a?t.replace("/flows/".concat(a)):(console.error("No flow ID in response:",r),b(!1))}catch(e){console.error("Failed to create flow:",e),b(!1)}})();return}if(!d||isNaN(d)){b(!1);return}(async()=>{try{let e=await j.x.get("/api/v1/flows/".concat(d));e.data&&i(e.data)}catch(e){console.error("Failed to load flow:",e)}finally{b(!1)}})()},[d,r,g,i,t]);let N=async()=>{if(!d){i(null),m(null),t.push("/flows");return}if(confirm("Are you sure you want to delete this workflow? This action cannot be undone.")){b(!0);try{await j.x.delete("/api/v1/flows/".concat(d)),i(null),m(null),t.push("/flows")}catch(e){console.error("Failed to delete flow:",e),alert("Failed to delete workflow. Please try again."),b(!1)}}};return p?(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)(o.Z,{}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,a.jsx)("div",{className:"px-6 pt-4",children:(0,a.jsx)(k.Z,{})}),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})]})]})}):!r&&(!d||isNaN(d))?(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)(o.Z,{}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,a.jsx)("div",{className:"px-6 pt-4",children:(0,a.jsx)(k.Z,{})}),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Invalid Flow ID"}),(0,a.jsx)("p",{className:"text-gray-600",children:"The flow ID in the URL is invalid."}),(0,a.jsx)("button",{onClick:()=>t.push("/flows"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Back to Flows"})]})})]})]})}):(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)(o.Z,{}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"h-screen flex flex-col",children:[(0,a.jsx)(_,{flowId:d,onDiscard:N,onOpenProperties:()=>y(!0)}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)(S,{}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(v,{flowId:d,onNodeSelect:e=>{m(e)}})}),(0,a.jsx)(E,{selectedNode:u,onUpdateNode:(e,t)=>{if(!c)return;let r=c.nodes.map(r=>r.id===e?{...r,data:t}:r);i({...c,nodes:r})},onClearSelection:()=>m(null)})]}),c&&d&&(0,a.jsx)(I,{flowId:d,initialData:c,isOpen:f,onClose:()=>y(!1)})]})})]})})}},9222:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(7437),s=r(1396),l=r.n(s),n=r(4033),o=r(2265);let d={"/dashboard":"Dashboard","/flows":"Flows","/crews":"Crews","/agents":"Agents","/tools":"Tools","/observability":"Observability","/chat":"Chat","/executions":"Executions","/settings":"Settings","/profile":"Profile"};function i(){let{breadcrumbs:e}=function(){let e=(0,n.usePathname)(),t=(0,o.useMemo)(()=>{if(!e)return[];let t=e.split("/").filter(Boolean),r=[];r.push({label:"Home",href:"/dashboard",isActive:"/dashboard"===e});let a="";return t.forEach((e,s)=>{a+="/".concat(e);let l=s===t.length-1;if(!isNaN(Number(e)))return;if("edit"===e){r.push({label:"Edit",href:a,isActive:l});return}let n=d[a]||e.charAt(0).toUpperCase()+e.slice(1);r.push({label:n,href:a,isActive:l})}),r},[e]),r=(0,o.useMemo)(()=>{if(!e)return"Home";let r=t[t.length-1];return(null==r?void 0:r.label)||"Home"},[e,t]);return{breadcrumbs:t,currentPage:r,pathname:e,isActive:t=>null==e?void 0:e.startsWith(t)}}();return e.length<=1?null:(0,a.jsx)("nav",{"aria-label":"Breadcrumb",className:"mb-4",children:(0,a.jsx)("ol",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:e.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[t>0&&(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-500 mx-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.isActive?(0,a.jsx)("span",{className:"text-gray-900 dark:text-gray-100 font-medium","aria-current":"page",children:e.label}):(0,a.jsx)(l(),{href:e.href,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:e.label})]},e.href))})})}},88:function(e,t,r){"use strict";r.d(t,{w:function(){return l}});var a=r(2265),s=r(6312);function l(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[n,o]=(0,a.useState)(null),d=(0,a.useCallback)(async()=>{l(!0),o(null);try{var e;let r=await s.x.get("/api/v1/flows");if(r.error)throw Error(r.error);t((null===(e=r.data)||void 0===e?void 0:e.flows)||[])}catch(e){o(e instanceof Error?e.message:"Failed to fetch flows"),console.error("Failed to fetch flows:",e)}finally{l(!1)}},[]),i=async e=>{let r=await s.x.post("/api/v1/flows",e);if(r.error)throw Error(r.error);let a=r.data;return t(e=>[...e,a]),a},c=async(e,r)=>{let a=await s.x.put("/api/v1/flows/".concat(e),r);if(a.error)throw Error(a.error);let l=a.data;return t(t=>t.map(t=>t.id===e?l:t)),l},u=async e=>{let r=await s.x.delete("/api/v1/flows/".concat(e));if(r.error)throw Error(r.error);t(t=>t.filter(t=>t.id!==e))},x=async e=>{let t=await s.x.get("/api/v1/flows/".concat(e));if(t.error)throw Error(t.error);return t.data};return(0,a.useEffect)(()=>{d()},[d]),{flows:e,loading:r,error:n,createFlow:i,updateFlow:c,deleteFlow:u,getFlow:x,refetch:d}}}},function(e){e.O(0,[780,311,279,628,67,971,458,744],function(){return e(e.s=1791)}),_N_E=e.O()}]);