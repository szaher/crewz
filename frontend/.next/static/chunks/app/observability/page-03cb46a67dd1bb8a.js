(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[926],{2100:function(e,t,s){Promise.resolve().then(s.bind(s,4509))},4509:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var r=s(7437),a=s(9755),l=s(8563),n=s(2265),i=s(6312);let o=[{label:"Last Hour",value:"1h",hours:1},{label:"Last 24 Hours",value:"24h",hours:24},{label:"Last 7 Days",value:"7d",hours:168},{label:"Last 30 Days",value:"30d",hours:720}];function c(e){let{title:t,value:s,subtitle:a,icon:l,trend:n,color:i="blue"}=e;return(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-1",children:t}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:s}),a&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:a}),n&&(0,r.jsxs)("div",{className:"flex items-center mt-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium ".concat(n.isPositive?"text-green-600":"text-red-600"),children:[n.isPositive?"↑":"↓"," ",Math.abs(n.value),"%"]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"vs last period"})]})]}),l&&(0,r.jsx)("div",{className:"text-4xl ".concat({blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",red:"bg-red-50 text-red-600",yellow:"bg-yellow-50 text-yellow-600"}[i]," p-3 rounded-lg"),children:l})]})})}var d=s(5253),x=s(3485),u=s(6573),m=s(4235),h=s(39),g=s(8670),b=s(1168),f=s(2969);function j(e){let{data:t}=e,s=t.map(e=>({time:new Date(e.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Total:e.count,Success:e.successCount,Failed:e.failedCount}));return 0===t.length?(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Execution Trends"}),(0,r.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,r.jsx)("p",{className:"text-sm",children:"No execution data available"})})]}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Execution Trends"}),(0,r.jsx)(d.h,{width:"100%",height:300,children:(0,r.jsxs)(x.w,{data:s,children:[(0,r.jsx)(u.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,r.jsx)(m.K,{dataKey:"time",stroke:"#6b7280",style:{fontSize:"12px"},angle:-45,textAnchor:"end",height:80}),(0,r.jsx)(h.B,{stroke:"#6b7280",style:{fontSize:"12px"}}),(0,r.jsx)(g.u,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),(0,r.jsx)(b.D,{wrapperStyle:{fontSize:"14px"},iconType:"line"}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"Total",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"Success",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981",r:4},activeDot:{r:6}}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"Failed",stroke:"#ef4444",strokeWidth:2,dot:{fill:"#ef4444",r:4},activeDot:{r:6}})]})})]})}var p=s(4033);function v(){let e=(0,p.useRouter)(),[t,s]=(0,n.useState)([]),[a,l]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{l(!0);try{var e;let t=await i.x.get("/api/v1/executions");if(t.error)throw Error(t.error);let r=((null===(e=t.data)||void 0===e?void 0:e.executions)||[]).filter(e=>"failed"===e.status).slice(0,10).map(e=>({id:e.id,flow_id:e.flow_id,flow_name:e.flow_name,error:e.error||"Unknown error",created_at:e.created_at,completed_at:e.completed_at}));s(r)}catch(e){console.error("Failed to fetch errors:",e)}finally{l(!1)}})()},[]),a)?(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Errors"}),(0,r.jsx)("div",{className:"animate-pulse space-y-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-16 bg-gray-200 rounded"},e))})]}):0===t.length?(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Errors"}),(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No errors found"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"All executions completed successfully"})]})]}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Errors"}),(0,r.jsx)("div",{className:"space-y-3",children:t.map(t=>(0,r.jsxs)("div",{onClick:()=>e.push("/executions/".concat(t.id)),className:"p-4 border border-red-200 bg-red-50 rounded-lg hover:bg-red-100 cursor-pointer transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Execution #",t.id]}),t.flow_name&&(0,r.jsx)("span",{className:"text-sm text-gray-600",children:t.flow_name})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleString()})]}),(0,r.jsx)("p",{className:"text-sm text-red-800 line-clamp-2",children:t.error})]},t.id))})]})}function y(e){let{value:t,onChange:s}=e;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Time Range:"}),(0,r.jsx)("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:o.map(e=>(0,r.jsx)("button",{onClick:()=>s(e.value),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-colors ".concat(t===e.value?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:e.label},e.value))})]})}function N(){let[e,t]=(0,n.useState)("24h"),{summary:s,trends:a,loading:l,error:d,refetch:x}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24h",t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[s,r]=(0,n.useState)(null),[a,l]=(0,n.useState)([]),[c,d]=(0,n.useState)(!0),[x,u]=(0,n.useState)(null),m=(0,n.useCallback)(async()=>{d(!0),u(null);try{var t;let s=o.find(t=>t.value===e)||o[1],a=new Date,n=new Date(a.getTime()-36e5*s.hours),c=await i.x.get("/api/v1/executions");if(c.error)throw Error(c.error);let d=((null===(t=c.data)||void 0===t?void 0:t.executions)||[]).filter(e=>new Date(e.created_at)>=n),x=d.length,u=d.filter(e=>"completed"===e.status).length,m=d.filter(e=>"failed"===e.status).length,h=d.filter(e=>"running"===e.status).length,g=d.filter(e=>"completed"===e.status&&e.started_at&&e.completed_at),b=g.length>0?g.reduce((e,t)=>{let s=new Date(t.started_at).getTime(),r=new Date(t.completed_at).getTime();return e+(r-s)},0)/g.length/1e3:0;r({totalExecutions:x,successCount:u,failedCount:m,runningCount:h,successRate:x>0?u/x*100:0,errorRate:x>0?m/x*100:0,avgExecutionTime:b});let f=s.hours<=24?1:24,j=new Map;d.forEach(e=>{let t=new Date(e.created_at),s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),1===f?t.getHours():0).toISOString(),r=j.get(s)||{count:0,success:0,failed:0};r.count++,"completed"===e.status&&r.success++,"failed"===e.status&&r.failed++,j.set(s,r)});let p=Array.from(j.entries()).map(e=>{let[t,s]=e;return{timestamp:t,count:s.count,successCount:s.success,failedCount:s.failed}}).sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime());l(p)}catch(e){u(e instanceof Error?e.message:"Failed to fetch metrics"),console.error("Failed to fetch metrics:",e)}finally{d(!1)}},[e]);return(0,n.useEffect)(()=>{m()},[m]),(0,n.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{m()},3e4);return()=>clearInterval(e)},[t,m]),{summary:s,trends:a,loading:c,error:x,refetch:m}}(e,!0);return l&&!s?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Observability"})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-3/4"})]},e))})]}):d?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Observability"}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,r.jsx)("p",{className:"text-red-800 mb-4",children:d}),(0,r.jsx)("button",{onClick:x,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})]}):s?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Observability"}),(0,r.jsx)("p",{className:"text-gray-500 mt-1",children:"Monitor your workflow executions and performance"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(y,{value:e,onChange:t}),(0,r.jsx)("button",{onClick:x,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh metrics",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(c,{title:"Total Executions",value:s.totalExecutions,icon:"⚙️",color:"blue",subtitle:"".concat(s.runningCount," running")}),(0,r.jsx)(c,{title:"Success Rate",value:"".concat(s.successRate.toFixed(1),"%"),icon:"✅",color:"green",subtitle:"".concat(s.successCount," successful")}),(0,r.jsx)(c,{title:"Error Rate",value:"".concat(s.errorRate.toFixed(1),"%"),icon:"❌",color:"red",subtitle:"".concat(s.failedCount," failed")}),(0,r.jsx)(c,{title:"Avg Execution Time",value:s.avgExecutionTime>0?"".concat(s.avgExecutionTime.toFixed(1),"s"):"N/A",icon:"⏱️",color:"yellow",subtitle:"For completed executions"})]}),(0,r.jsx)(j,{data:a}),(0,r.jsx)(v,{}),(0,r.jsx)("div",{className:"text-center text-xs text-gray-500",children:"Auto-refreshing every 30 seconds"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Observability"}),(0,r.jsxs)("div",{className:"bg-white p-12 rounded-lg border border-gray-200 text-center",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Execution Data Yet"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Execute a flow to start seeing metrics and analytics"}),(0,r.jsx)("button",{onClick:()=>window.location.href="/flows",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Go to Flows"})]})]})}function w(){return(0,r.jsx)(a.Z,{children:(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(N,{})})})]})})}}},function(e){e.O(0,[311,497,67,971,458,744],function(){return e(e.s=2100)}),_N_E=e.O()}]);